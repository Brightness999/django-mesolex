{% extends 'base.html' %}
{% load lexeme_tags %}
{% load i18n %}

{% block content %}
    {# TODO: use this to construct dynamic filters #}
    <div class="empty-formset-form" style="display: none;">
        {{ formset.empty_form }}
    </div>

    {% if query %}
    <div class="row">
        <div class="col-12">
            {% if page_obj.object_list %}
            {% for result in page_obj.object_list %}
            {% with data=result.object.data %}
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        {{ result.object.headword }}
                    </h5>
                    <h6 class="text-muted font-weight-light">({{ data.catgrGroup.catgr }})</h6>
                    {% if data.lx_alt %}
                        <h6 class="card-subtitle text-muted font-weight-light">
                            Alt. form{{ data.lx_alt|ensure_list|pluralize }}:
                            {% for lx_alt in data.lx_alt|ensure_list %}
                                {{ lx_alt }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        </h6>
                    {% endif %}
                </div>
                <div class="card-body">

                    {% for sig in result.object.data.sigGroup|ensure_list %}
                    <p class="card-text">{{ sig.sig }}</p>
                        {% if sig.fr_nGroup %}
                            {% for fr in sig.fr_nGroup|ensure_list %}
                            <blockquote class="card-text example font-weight-light pl-4">
                                {{ fr.fr_n }} <i>({{ fr.fr_e }})</i>
                            </blockquote>
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            {% endwith %}
            {% endfor %}

            {% if page_obj.has_previous or page_obj.has_next %}
                <ul class="pagination">
                    <li class="page-item{% if not page_obj.has_previous %} disabled{% endif %}">
                        {% if page_obj.has_previous %}
                            <a class="page-link" href="?q={{ query }}&amp;page={{ page_obj.previous_page_number }}">
                        {% else %}
                            <span class="page-link">
                        {% endif %}
                        &laquo; {% trans 'Previous' %}
                        {% if page_obj.has_previous %}
                            </a>
                        {% else %}
                            </span>
                        {% endif %}
                    </li>
                    <li class="page-item{% if not page_obj.has_next %} disabled{% endif %}">
                        {% if page_obj.has_next %}
                            <a class="page-link" href="?q={{ query }}&amp;page={{ page_obj.next_page_number }}">
                        {% else %}
                            <span class="page-link">
                        {% endif %}
                        {% trans 'Next' %} &raquo;
                        {% if page_obj.has_next %}
                            </a>
                        {% else %}
                            </span>
                        {% endif %}
                    </li>
                </ul>
            {% endif %}

            {% else %}
            <p>
                {% trans 'No results found.' %}
            </p>
            {% endif %}
        </div>
    </div>
    {% endif %}
{% endblock %}
